<div class="columns mt-5">
    <div class="column is-3">
        <div class="card">
            <div class="card-content">
                <div class="field">
                    <label class="label">Cliente:</label>
                    <div class="control">
                        <div class="select">
                            <select id='cliente_Seleccionado' (change)='buscar_producto($event.target.value)' value=''>
                                <option value="">Seleccionar Cliente</option>
                                <option *ngFor='let cliente of CLIENTES' value='{{cliente._id}}'>{{cliente.nombre}}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <button class="button is-primary" (click)='Modal_Cliente()' *ngIf='usuario.Maquinaria == 2 && !edicion'>
                    <span class="icon">
                        <i class="fas fa-address-book"></i>
                    </span>
                    <span>
                        Nuevo Cliente
                    </span>
                </button>
                <button class="button is-primary" (click)='Modal_Edit_cliente()' *ngIf='usuario.Maquinaria == 2 && edicion'>
                    <span class="icon">
                        <i class="fas fa-user-edit"></i>
                    </span>
                    <span>
                        Editar Cliente
                    </span>
                </button>
            </div>
        </div>
    </div>
    <div class="column">
        <div class="card">
            <div class="card-content">
                <div class="titulo">Productos</div>
                <button class="button is-primary" (click)='Modal_Producto()' disabled id='NP_button' *ngIf='usuario.Maquinaria == 2'>
                    <span class="icon">
                        <i class="fas fa-list-ol"></i>
                    </span>
                    <span>
                        Nuevo Producto
                    </span>
                </button>
                <hr>
                <table class="table is-fullwidth">
                    <thead>
                        <tr>
                            <th>Especificación</th>
                            <th>Nombre del Producto</th>
                            <th>Ver</th>
                            <th *ngIf='usuario.Maquinaria == 2'>Editar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor='let producto of PRODUCTOS;let i = index'>
                            <td>E - {{producto.cliente.codigo}} - {{producto.codigo}} - {{producto.version}} - {{producto.edicion}}</td>
                            <td>{{producto.producto}}</td>
                            <td>
                                <button class="button is-info is-outlined" (click)='verProducto(producto._id)'>
                                    <span class="icon is-small">
                                        <i class="far fa-eye"></i>
                                    </span>
                                    <span>Ver</span>
                                </button>
                            </td>
                            <td *ngIf='usuario.Maquinaria == 2'>
                            
                            <button class="button is-success is-outlined" (click)='editar(producto._id)'>
                                <span class="icon is-small">
                                    <i class="far fa-edit"></i>
                                </span>
                                <span>Editar</span>
                            </button>
                        </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal" [ngClass]="{'is-active':Edit_cliente}" *ngIf="edicion">
    <div class="modal-background" (click)="Modal_Edit_cliente()"></div>
    <div class="modal-card">
        <div class="modal-card-body">
            <div class="subtitulo">Editar Cliente</div>
            <hr>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Nombre del Cliente:</label>
                        <div class="control">
                            <input type="text" class="input" [(ngModel)]="cliente_selected.nombre">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Rif:</label>
                        <div class="control">
                            <input type="text" class="input" [(ngModel)]="cliente_selected.rif">
                        </div>
                    </div>
                </div>
                <div class="column is-3">
                    <div class="field">
                        <label class="label">Cód. Cliente:</label>
                        <div class="control">
                            <input type="text" class="input" [(ngModel)]="cliente_selected.codigo">
                        </div>
                    </div>
                </div>
            </div>
            <div class="field">
                <label class="label">Dirección fiscal:</label>
                <textarea class="textarea" placeholder="Dirección Fiscal" [(ngModel)]="cliente_selected.direccion"></textarea>
            </div>
            <table class="table is-fullwidth">
                <tr>
                    <th colspan="3">Contactos:</th>
                </tr>
                <tr *ngFor="let contacto of cliente_selected.contactos;index as i">
                    <td>
                        <label class="label">Nombre:</label>
                                <div class="field has-addons">
                                    <p class="control">
                                        <span class="select">
                                            <select [(ngModel)]="cliente_selected.contactos[i].trato">
                                              <option value="Sr.">Sr.</option>
                                              <option value="Sra.">Sra.</option>
                                            </select>
                                          </span>
                                    </p>
                                    <p class="control">
                                        <input type="text" class="input" id='Nombre_cn' [(ngModel)]="cliente_selected.contactos[i].nombre">
                                    </p>
                                </div>
                        <div class="columns">
                            <div class="column is-half">
                                <div class="field">
                                <label class="label">Cargo:</label>
                                    <div class="control">
                                        <input type="text" class="input" [(ngModel)]="cliente_selected.contactos[i].cargo">
                                    </div>
                                </div>
                            </div>
                            <div class="column is-two-thirds">
                                <div class="field">
                                <label class="label">Correo:</label>
                                    <div class="control">
                                        <input type="text" class="input" [(ngModel)]="cliente_selected.contactos[i].email">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                            
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label"> </label>
                                    <div class="control">
                                        <button class="button is-danger is-outlined is-small" (click)="eliminarContacto(i)">Eliminar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
            <table class="table is-fullwidth">
                <tr>
                    <td>
                        <label class="label">Nombre:</label>
                                <div class="field has-addons">
                                    <p class="control">
                                        <span class="select">
                                            <select #trato>
                                              <option value="Sr.">Sr.</option>
                                              <option value="Sra.">Sra.</option>
                                            </select>
                                          </span>
                                    </p>
                                    <p class="control">
                                        <input type="text" class="input" id='Nombre_cn' #Nombre_Contacto>
                                    </p>
                                </div>
                        <div class="columns">
                            <div class="column is-half">
                                <div class="field">
                                    <label class="label">Cargo:</label>
                                    <div class="control">
                                        <input type="text" id="Cargo_c" class="input" #Cargo_Contacto>  
                                    </div>
                                </div>
                            </div>
                            <div class="column is-two-thirds">
                                <div class="field">
                                    <label class="label">Email:</label>
                                    <div class="control">
                                        <input type="text" id="Email_c" class="input" #Correo_Contacto>
                                    </div>
                                </div>
                            </div>
                            <div class="columns">

                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label"> </label>
                                    <div class="control">
                                        <button class="button is-success is-outlined is-small" (click)="AgregarContacto(Nombre_Contacto.value, Cargo_Contacto.value, Correo_Contacto.value, trato.value)">Agregar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
            <table class="table is-fullwidth">
                <tr>
                    <th colspan="2">Almacenes</th>
                    
                </tr>
                <tr *ngFor="let almacen of cliente_selected.almacenes;index as i" [id]="i">
                    <td>
                        <input type="text" class="input" [id]='i' [(ngModel)]="cliente_selected.almacenes[i]">
                    </td>
                    <td>
                        <button class="button is-danger is-outlined is-small" (click)="ElminarAlmacen(i)">Eliminar</button>
                    </td>
                </tr>
            </table>
            <table class="table is-fullwidth">
                <tr>
                    <td>
                        <input type="text" class="input" placeholder="Nuevo Almacen" #NewAlmacen>
                    </td>
                    <td>
                        <button class="button is-success is-outlined is-small" (click)="AgregarAlmacen(NewAlmacen.value)">Agregar</button>
                    </td>
                </tr>
            </table>
            <button class="button is-success" (click)="Editar_Cliente()">Finalizar</button>
        </div>
    </div>
</div>

<div class="modal" [ngClass]="{'is-active':NUEVO_CLIENTE}">
    <div class="modal-background" (click)='Modal_Cliente()'></div>
    <div class="modal-card">
        <div class="modal-card-body">
            <form
            autocomplete="off"
            [formGroup]="ClienteForm"
            (ngSubmit)="addCliente()">
                <div class="subtitulo">Nuevo Cliente</div>
                <hr>
                <div class="columns">
                    <div class="column">
                        <div class="field">
                            <label class="label">Nombre del Cliente:</label>
                            <div class="control">
                                <input type="text" class="input" formControlName='nombre'>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="field">
                            <label class="label">Rif:</label>
                            <div class="control">
                                <input type="text" class="input" formControlName='rif'>
                            </div>
                        </div>
                    </div>
                    <div class="column is-3">
                        <div class="field">
                            <label class="label">Cód. Cliente:</label>
                            <div class="control">
                                <input type="text" class="input" formControlName='codigo'>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field">
                    <label class="label">Dirección fiscal:</label>
                    <div class="control">
                        <textarea class="textarea" formControlName='direccion'></textarea>
                    </div>
                </div>
                <table class="table is-fullwidth">
                    <thead>
                        <th colspan="2">
                            Contactos:
                        </th>
                    </thead>
                    <tbody>
                        <tr *ngFor="let contacto of contactos;index as i">
                            <td>
                                <b>Nombre: </b>{{contacto.nombre}} <b>Cargo: </b>{{contacto.cargo}} <br><b>Email: </b>{{contacto.email}}
                            </td>
                            <td>
                                <a (click)="contact_delete(i)"><i class="fas fa-trash-alt" style="color: #ff0000;"></i></a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label class="label">Nombre:</label>
                                <div class="field has-addons">
                                    <p class="control">
                                        <span class="select">
                                            <select #trato>
                                              <option value="Sr.">Sr.</option>
                                              <option value="Sra.">Sra.</option>
                                            </select>
                                          </span>
                                    </p>
                                    <p class="control">
                                        <input type="text" class="input" id='Nombre_cn' #Nombre_cn (keydown)="nombre_cont($event.target.value)" (change)="nombre_cont($event.target.value)">
                                    </p>
                                </div>
                                <div class="columns">
                                <div class="column is-half">
                                    <div class="field">
                                        <label class="label">Cargo:</label>
                                        <div class="control">
                                            <input type="text" class="input" id="Cargo_cn" #Cargo_cn (keydown)="cargo_cont($event.target.value)"  (change)="cargo_cont($event.target.value)" [disabled]="!Nombre_contact">
                                        </div>
                                    </div>
                                </div>
                                <div class="column is-two-thirds">
                                    <div class="field">
                                        <label class="label">Email:</label>
                                        <div class="control">
                                            <input type="email" class="input" id="Email_cn" required #Email_cn  [disabled]="!Cargo_contact" (keydown)="email_cont($event.target.value)"  (change)="email_cont($event.target.value)">
                                        </div>
                                    </div>
                                </div>
                                <div class="column">

                                </div>
                                </div>
                            </td>
                            <td>
                                <div class="field">
                                    <label class="label"> </label>
                                    <div class="control">
                                        <button class="button is-success is-outlined" (click)="agregarContactoNuevo(Nombre_cn.value, Cargo_cn.value, Email_cn.value, trato.value)" [disabled]="!enable_contact">Agregar</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table is-fullwidth">
                    
                </table>
                <table class="table is-fullwidth">
                    <thead>
                        <th>Nombre de almacen</th>
                    </thead>
                    <tbody>
                        <tr *ngFor="let almacen of almacenes;let i from index">
                            <td>
                                {{almacen}}

                                <span class="icon" (click)="delete_this_almacen(i)">
                                    <i class="fas fa-times"></i>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="columns">
                    <div class="column">
                        <div class="field">
                            <div class="control">
                                <input type="text" class="input" id="almacen_nuevo" formControlName='almacenes' [(ngModel)]="new_almacen" name="nuevoAlmacen">
                            </div>
                        </div>
                    </div>
                    <div class="column is-3">
                        <button class="button is-success is-outlined" (click)="add_almacen()" [disabled]="!new_almacen">Agregar</button>
                    </div>
                </div>
                <br>                
                <button class="button is-primary">Nuevo Cliente</button>
            </form>
        </div>
    </div>
</div>

<div class="modal" [ngClass]="{'is-active':NUEVO_PRODUCTO}">
    <div class="modal-background" (click)='Modal_Producto()'></div>
    <div class="modal-card">
        <div class="modal-card-body tabla">
            <div class="subtitulo">
                Nuevo Producto
            </div>
            <div class="separador">
                Información del producto
            </div>
            <br>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Nombre Producto</label>
                        <div class="control">
                            <input type="text" class="input" id='nombre_nuevo_producto' placeholder="Nombre Producto">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Categoria</label>
                        <div class="select">
                            <select id='grupo_producto'>
                                <option *ngFor='let grupo of GRUPOS' value="{{grupo._id}}">{{grupo.nombre}}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Cod. Producto</label>
                        <div class="control">
                            <input type="text" class="input" id='cod_producto' placeholder="Código de producto">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Versión</label>
                        <div class="control">
                            <input type="text" class="input" id='version' placeholder="Versión">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Especificación</label>
                        <div class="control">
                            <input type="text" class="input" id='edicion' placeholder="Especificación">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Código de producto de cliente</label>
                        <div class="control">
                            <input type="text" class="input" placeholder="Código de producto de cliente" id="cod_cliente">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <input type="checkbox" name="troquelado" id="troquelado" (click)='post_impresion("Troquelado")'><label> Troquelado</label><br>
                    <input type="checkbox" name="pegado" id="pegado" (click)='post_impresion("Pegado")'><label> Pegado</label><br>
                    <input type="checkbox" name="corte" id="corte" (click)='post_impresion("Corte Recto")'><label> Corte Recto</label><br>
                </div>
            </div>
            <div class="separador">
                Pre Impresión
            </div>
            <br>

            <!-- <div class="columns"> -->
            
            <div class="columns is-3">
                <div class="column">
                    <div class="columns">
                        <div class="column">
                            <label for="" class="label">Cantidad de montajes:</label>
                        </div>
                        <div class="column is-4">
                            <div class="control">
                                <input type="number" class="input" min="1" max="5" placeholder="Cantidad de montajes" [(ngModel)]="montajes">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column ">
                    <div class="columns">
                        <div class="column">
                            <label for="" class="label">Montaje:</label>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select">
                                        <select name="montajes" [(ngModel)]="i_montajes">
                                            <option value="{{i}}" *ngFor="let e of [].constructor(montajes); let i = index">Montaje {{NumToLet(i)}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="separador">
                Materia Prima - Montaje
            </div>
            <br>
            <div class="columns">
                <div class="column">
                    <div class="columns">
                        <div class="column">
                            <label class="label">Ejemplares montados:</label>
                        </div>
                        <div class="column is-4">
                            <div class="field">
                                <div class="control">
                                    <input type="number" class="input" placeholder="Ejemplares montados" (change)="Ejemplar($event.target.value)" [(ngModel)]="EJEMPLARES[i_montajes]">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column">
                </div>
            </div>

            <div class="materiales" *ngFor="let e of [].constructor(montajes); let i = index">
                <table class="table is-fullwidth" *ngIf="i == i_montajes">
                    <thead>
                    <tr>
                            <th>Materia</th>
                            <th>Marca</th>
                            <th>Cantidad</th>
                            <th>Eliminar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor='let Material of MATERIALES_NECESARIOS[i_montajes]'>
                            <td>{{Material.material}} 
                                <ng-container *ngIf='Material.ancho'>
                                    ({{Material.ancho}} x {{Material.ancho}})
                                </ng-container>
                            </td>
                            <td>{{Material.marca}}</td>
                            <td>{{Material.cantidad}}</td>
                            <td>
                                <button class="button is-danger is-outlined is-small" (click)='Delete_Material(Material.material)'>
                                    <span class="icon is-small">
                                      <i class="fas fa-check"></i>
                                    </span>
                                    <span>Eliminar</span>
                                  </button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="columns" *ngIf="i == i_montajes">
                    <div class="column">
                        <div class="field">
                            <label class="label">Categoria:</label>
                            <div class="select">
                                <select name="" id="" (change)='selecciona_producto($event.target.value)'>
                                    <option value="#">Selecciona Categoria</option>
                                    <option value="{{seccion.nombre}}" *ngFor='let seccion of SECCIONES'>{{seccion.nombre}}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="columns" *ngIf="i == i_montajes">
                    <div class="column">
                        <div class="field">
                            <label class="label">Producto:</label>
                            <div class="select">
                                <select name="" id="{{i_montajes}}" (change)='producto_seleccionado($event.target.value)' #producto>
                                    <option value="0">Selecciona Producto</option>
                                    <ng-container *ngFor='let producto of MATERIALES'>
                                        <ng-container *ngIf='producto.grupo.nombre === product_selected'>
                                            <option value="{{producto._id}}">{{producto.nombre}} ({{producto.marca}})
                                                <ng-container *ngIf='producto.ancho'>
                                                    ({{producto.ancho}} x {{producto.largo}} Gramaje:{{producto.gramaje}} Calibre:{{producto.calibre}}
                                                </ng-container>
                                            </option>
                                        </ng-container>
                                    </ng-container>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="field" id='cant'>
                            <label class="label">Cantidad:</label>
                            <div class="control">
                                <input type="text" id='cantidad{{i}}' class="input" #size [disabled]='!_producto_seleccionado'>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="field" *ngIf="i == i_montajes">
                        <label class="label"></label>
                        <div class="control">
                            <button class="button is-success is-outlined" (click)="add_materia(i, size, producto)">
                                <span class="icon is-small">
                                  <i class="fas fa-check"></i>
                                </span>
                                <span>Agregar</span>
                              </button>
                        </div>
                    </div>
            </div>
            <hr>
            <button class="button is-primary" (click)='finalizar()'>Registrar Producto</button>
        </div>
    </div>
</div>

<div class="modal" [ngClass]="{'is-active':VER_PRODUCTO}">
    <div class="modal-background" (click)='ver_Modal_Producto()'></div>
    <div class="modal-card">
        <div class="modal-card-body">
            <div class="columns">
                <div class="column">
                    <figure class="image is-4by5">
                        <img src="{{ImageProducto}}">
                    </figure>
                </div>
                <div class="column is-5">
                    <table class="table">
                        <thead>
                            <th>
                                Especificación del Producto
                            </th>
                        </thead>
                        <tbody><tr>
                            <td>
           E-{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-{{OneProduct.edicion}}
                            </td></tr>
                            <tr>
                                <td>
                                    <br>
                                    <br>
                                    <div class="file is-small has-name is-primary">
                                        <label class="file-label">
                                          <input class="file-input" type="file" name="resume"
                                          (change)="CambiarImagen($event)">
                                          <span class="file-cta">
                                            <span class="file-icon">
                                              <i class="fas fa-upload"></i>
                                            </span>
                                            <span class="file-label">
                                              Seleccionar Imagen
                                            </span>
                                          </span>
                                          <span class="file-name">
                                            Sin archivo
                                          </span>
                                        </label>
                                      </div>
                                    <!--
                                        
                                    -->
                                    <button class="button is-primary mt-5 is-small"
                                    [disabled]="!ImgSubir"
                                    [ngClass]="{'is-loading': cargando}"
                                    (click)='subirImagen()'>
                                    Cambiar imagen
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="separador">
                Identificación del Producto
            </div>
            <br>
            
            <table class="table is-fullwidth">
                <tr>
                    <th>Cliente:</th>
                    <td>{{OneProduct.cliente.nombre}}</td>
                </tr>
                <tr>
                    <th>Producto:</th>
                    <td>{{OneProduct.producto}}</td>
                </tr>
                <tr>
                    <th>Código del producto:</th>
                    <td>{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}</td>
                </tr>
            </table>

            <div class="field">
                <label class="label">Montaje</label>
                <div class="select">
                    <select id="" class="select" (click)="cambiarCalculo()" name="montaje" [(ngModel)]="i_montajes">
                        <option value="{{i}}" *ngFor="let e of [].constructor(OneProduct.montajes); let i = index">M-{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-{{NumToLet(i)}}</option>
                    </select>
                </div>
            </div>

            <div class="separador">
                Materia Prima
            </div>
            <br>

            <table class="table is-fullwidth">
                <thead>
                    <th>
                        Sustrato
                    </th>
                </thead>
                <tbody>
                    <ng-container *ngIf="this.OneProduct.materiales[this.i_montajes_]">
                        <tr *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                            <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo  && TintaProducto.producto.grupo.nombre === 'Sustrato'">
                                <td>
                                    {{TintaProducto.producto.nombre}} ({{TintaProducto.producto.ancho}} x {{TintaProducto.producto.largo}})
                                    <br>
                                    <table class="table is-bordered">
                                        <thead>
                                            <th>Calibre (pt.)</th>
                                            <th>Gramaje (g/m²):</th>
                                            <th>Dirección de fibra:</th>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>{{TintaProducto.producto.calibre}}</td>
                                                <td>{{TintaProducto.producto.gramaje}}</td>
                                                <td>{{TintaProducto.producto.largo}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </ng-container>
                        </tr>
                    </ng-container>
                </tbody>
            </table>

            <table class="table is-fullwidth">
                <thead>
                    <th>
                        Colores Aprobados:
                    </th>
                    <th>
                        Tintas (Marca):
                    </th>
                </thead>
                <tbody>
                    <tr *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Tinta'">
                            <td>
                                {{TintaProducto.producto.color}}
                            </td>
                            <td>
                                {{TintaProducto.producto.nombre}}({{TintaProducto.producto.marca}})
                            </td>
                        </ng-container>
                    </tr>
                </tbody>
            </table>
            <table class="table is-fullwidth">
                <thead>
                    <th>
                        Barniz aprobado 
                    </th>
                </thead>
                <tbody>
                    <tr *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Barniz'">
                            {{TintaProducto.producto.nombre}} ({{TintaProducto.producto.marca}})
                        </ng-container>
                    </tr>
                </tbody>
            </table>
            <div class="separador">
                Pre impresión
            </div>
            <br>

            <table class="table is-fullwidth">
                <thead>
                    <th>
                        Código de peliculas:
                    </th>
                    <td>
                        <ng-container tr *ngFor="let TintaProducto of OneProduct.materiales[i_montajes];let i = index">
                            <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Tinta'">
                                <p *ngIf="TintaProducto.producto.color === 'Negro'"><b>Negro:</b>{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-
                                    <!-- {{NumToLet(i_montajes)}} -->
                                    <ng-container *ngIf="i_montajes == 0">A</ng-container>
                                    <ng-container *ngIf="i_montajes == 1">B</ng-container>
                                    <ng-container *ngIf="i_montajes == 2">C</ng-container>
                                    <ng-container *ngIf="i_montajes == 3">D</ng-container>
                                    <ng-container *ngIf="i_montajes == 4">E</ng-container>
                                    -1 </p>
                                <p *ngIf="TintaProducto.producto.color === 'Cyan'"><b>Cyan:</b>{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-
                                    <ng-container *ngIf="i_montajes == 0">A</ng-container>
                                    <ng-container *ngIf="i_montajes == 1">B</ng-container>
                                    <ng-container *ngIf="i_montajes == 2">C</ng-container>
                                    <ng-container *ngIf="i_montajes == 3">D</ng-container>
                                    <ng-container *ngIf="i_montajes == 4">E</ng-container>
                                    -2 </p>
                                <p *ngIf="TintaProducto.producto.color === 'Magenta'"><b>Magenta:</b>{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-
                                    <ng-container *ngIf="i_montajes == 0">A</ng-container>
                                    <ng-container *ngIf="i_montajes == 1">B</ng-container>
                                    <ng-container *ngIf="i_montajes == 2">C</ng-container>
                                    <ng-container *ngIf="i_montajes == 3">D</ng-container>
                                    <ng-container *ngIf="i_montajes == 4">E</ng-container>
                                    -3 </p>
                                <p *ngIf="TintaProducto.producto.color === 'Amarillo'"><b>Amarillo:</b>{{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-
                                    <ng-container *ngIf="i_montajes == 0">A</ng-container>
                                    <ng-container *ngIf="i_montajes == 1">B</ng-container>
                                    <ng-container *ngIf="i_montajes == 2">C</ng-container>
                                    <ng-container *ngIf="i_montajes == 3">D</ng-container>
                                    <ng-container *ngIf="i_montajes == 4">E</ng-container>
                                    -4 </p>
                                <div *ngIf="TintaProducto.producto.color != 'Amarillo' && TintaProducto.producto.color != 'Magenta' && TintaProducto.producto.color != 'Cyan' && TintaProducto.producto.color != 'Negro' ">
                                    <b>{{TintaProducto.producto.color}}:</b> 
                                    <ng-container *ngIf="cinco">
                                        {{OneProduct.cliente.codigo}}-{{OneProduct.codigo}}-{{OneProduct.version}}-
                                    <ng-container *ngIf="i_montajes == 0">A</ng-container>
                                    <ng-container *ngIf="i_montajes == 1">B</ng-container>
                                    <ng-container *ngIf="i_montajes == 2">C</ng-container>
                                    <ng-container *ngIf="i_montajes == 3">D</ng-container>
                                    <ng-container *ngIf="i_montajes == 4">E</ng-container>
                                    <ng-container *ngIf="i_montajes == 0">
                                        -{{sumaTintas(i, TintaProducto.producto.color)}}
                                    </ng-container>    
                                    <ng-container *ngIf="i_montajes != 0">
                                        -{{sumaTintas(i, TintaProducto.producto.color) - 2}}
                                    </ng-container>    
                                    </ng-container>
                                </div>
                            </ng-container>
                        </ng-container>
                    </td>
                </thead>
            </table>
            <div class="separador">
                Impresión
            </div>
            <br>

            <table class="table is-fullwidth">
                <thead>
                    <th>Tamaño de Impresión</th>
                    <th>Ejemplares montados</th>
                </thead>
                <tbody>
                    <td>
                        <table class="table is-bordered">
                            <thead>
                                <th>Ancho</th>
                                <th>Largo</th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                                    <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Sustrato'">
                                        <td>{{TintaProducto.producto.ancho}} cm.</td>
                                        <td>{{TintaProducto.producto.largo}} cm.</td>
                                    </ng-container>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td>
                       {{ OneProduct.ejemplares[i_montajes] }} Ejemplares
                    </td>
                </tbody>
            </table>
            <div class="separador">
                Post Impresión
            </div>
            <br>
            <table class="table is-fullwidth">
                <thead>
                    <ng-container *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Pega'">
                            <th>Pegamento aprobado</th>
                        </ng-container>
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Cajas Corrugadas'">
                            <th>Cantidad de unidades por caja</th>
                        </ng-container>
                    </ng-container>
                </thead>
                <tbody>
                    <ng-container *ngFor="let TintaProducto of OneProduct.materiales[i_montajes]">
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Pega'">
                        <td>
                            {{TintaProducto.producto.nombre}} ({{TintaProducto.producto.marca}})
                        </td>
                        </ng-container>
                        <ng-container *ngIf="TintaProducto && TintaProducto.producto && TintaProducto.producto.grupo && TintaProducto.producto.grupo.nombre === 'Cajas Corrugadas'">
                            <td>{{TintaProducto.cantidad}}</td>
                        </ng-container>
                    </ng-container>
                </tbody>
            </table>
            <button class="button is-small is-info" routerLink="/prueba/{{OneProduct._id}}">
                <span class="icon">
                    <i class="fas fa-info-circle"></i>
                </span>
                <span>
                    Especificación
                </span>
            </button>
        </div>
    </div>
</div>


<div class="modal" [ngClass]="{'is-active':EDITAR_PRODUCTO}">
    <div class="modal-background" (click)='Modal_Producto_E()'></div>
    <div class="modal-card">
        <div class="modal-card-body tabla">
            <div class="subtitulo">
                Editar Producto
            </div>
            <div class="separador">
                Información del producto
            </div>
            <br>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Nombre Producto</label>
                        <div class="control">
                            <input type="text" class="input" id='nombre_nuevo_producto' placeholder="Nombre Producto" [(ngModel)]="OneProduct.producto">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Categoria</label>
                        <div class="select">
                            <select id='grupo_producto' [(ngModel)]="OneProduct.grupo._id">
                                <option *ngFor='let grupo of GRUPOS' value="{{grupo._id}}">{{grupo.nombre}}</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Cod. Producto</label>
                        <div class="control">
                            <input type="text" class="input" id='cod_producto' placeholder="Código de producto" [(ngModel)]="OneProduct.codigo">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Versión</label>
                        <div class="control">
                            <input type="text" class="input" id='version' placeholder="Versión" [(ngModel)]="OneProduct.version">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="field">
                        <label class="label">Especificación</label>
                        <div class="control">
                            <input type="text" class="input" id='edicion' placeholder="Especificación" [(ngModel)]="OneProduct.edicion">
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns">
                <div class="column">
                    <div class="field">
                        <label class="label">Código de producto de cliente</label>
                        <div class="control">
                            <input type="text" class="input" placeholder="Código de producto de cliente" id="cod_cliente" [(ngModel)]="OneProduct.cod_cliente">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <input type="checkbox" name="troquelado" id="troquelado" (click)='post_impresion("Troquelado")'><label> Troquelado</label><br>
                    <input type="checkbox" name="pegado" id="pegado" (click)='post_impresion("Pegado")'><label> Pegado</label><br>
                    <input type="checkbox" name="corte" id="corte" (click)='post_impresion("Corte Recto")'><label> Corte Recto</label><br>
                </div>
            </div>
            <div class="separador">
                Pre Impresión
            </div>
            <br>

            <!-- <div class="columns"> -->
            
            <div class="columns is-3">
                <div class="column">
                    <div class="columns">
                        <div class="column">
                            <label for="" class="label">Cantidad de montajes:</label>
                        </div>
                        <div class="column is-4">
                            <div class="control">
                                <input type="number" class="input" min="1" max="5" placeholder="Cantidad de montajes" [(ngModel)]="OneProduct.montajes">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column ">
                    <div class="columns">
                        <div class="column">
                            <label for="" class="label">Montaje:</label>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select">
                                        <select name="montajes" [(ngModel)]="i_montajes_">
                                            <option value="{{i}}" *ngFor="let e of [].constructor(OneProduct.montajes); let i = index">Montaje {{NumToLet(i)}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="separador">
                Materia Prima - Montaje
            </div>
            <br>
            <div class="columns">
                <div class="column">
                    <div class="columns">
                        <div class="column">
                            <label class="label">Ejemplares montados:</label>
                        </div>
                        <div class="column is-4">
                            <div class="field">
                                <div class="control">
                                    <input type="number" class="input" placeholder="Ejemplares montados" (change)="Ejemplar($event.target.value)" [(ngModel)]="OneProduct.ejemplares[i_montajes_]">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column">
                </div>
            </div>

            <div class="materiales" *ngFor="let e of [].constructor(OneProduct.montajes); let i = index">
                <ng-container *ngIf="OneProduct.materiales[i_montajes_]">
                    <table class="table is-fullwidth" *ngIf="i == i_montajes_">
                        <thead>
                        <tr>
                                <th></th>
                                <th>Materia</th>
                                <th>Marca</th>
                                <th>Cantidad</th>
                                <th>Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container >
                                <tr *ngFor='let Material of OneProduct.materiales[i_montajes_];index as x'>
                                    <td>
                                        <i class="fas fa-arrow-up" style="font-size: xx-small; cursor:pointer" (click)="moveUp(x)"></i> <br>
                                        <i class="fas fa-arrow-down" style="font-size: xx-small; cursor:pointer" (click)="moveDown(x)"></i>
                                    </td>
                                    <td *ngIf="Material.producto.nombre">
                                        {{Material.producto.nombre}} 
                                        <ng-container *ngIf='Material.ancho'>
                                            ({{Material.producto.ancho}} x {{Material.producto.ancho}})
                                        </ng-container>
                                    </td>
                                    <td *ngIf="Material.material">
                                        {{Material.material}} 
                                        <ng-container *ngIf='Material.ancho'>
                                            ({{Material.producto.ancho}} x {{Material.producto.ancho}})
                                        </ng-container>
                                    </td>
                                    <td *ngIf="Material.producto.marca">{{Material.producto.marca}}</td>
                                    <td *ngIf="Material.marca">{{Material.marca}}</td>
                                    <td>
                                        <input type="text" class="input" [(ngModel)]="OneProduct.materiales[i_montajes_][x].cantidad">
                                    </td>
                                    <td>
                                        <button class="button is-danger is-outlined is-small" (click)='Delete_Material2(Material.producto.nombre)'>
                                            <span class="icon is-small">
                                              <i class="fas fa-check"></i>
                                            </span>
                                            <span>Eliminar</span>
                                          </button>
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </ng-container>

                <div class="columns" *ngIf="i == i_montajes_">
                    <div class="column">
                        <div class="field">
                            <label class="label">Categoria:</label>
                            <div class="select">
                                <select name="" id="" (change)='selecciona_producto2($event.target.value)'>
                                    <option value="0">Selecciona Categoria</option>
                                    <option value="{{seccion.nombre}}" *ngFor='let seccion of SECCIONES'>{{seccion.nombre}}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="columns" *ngIf="i == i_montajes_">
                    <div class="column">
                        <div class="field">
                            <label class="label">Producto:</label>
                            <div class="select">
                                <select name="" id="x-{{i}}" (change)='producto_seleccionado($event.target.value)' disabled #producto>
                                    <option value="0"> Selecciona Producto</option>
                                    <ng-container *ngFor='let producto of MATERIALES'>
                                        <ng-container *ngIf='producto.grupo.nombre === product_selected'>
                                            <option value="{{producto._id}}">{{producto.nombre}} ({{producto.marca}})
                                                <ng-container *ngIf='producto.ancho'>
                                                    ({{producto.ancho}} x {{producto.largo}}) Gramaje: {{producto.gramaje}}, Calibre: {{producto.calibre}}
                                                </ng-container>
                                            </option>
                                        </ng-container>
                                    </ng-container>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="field" id='cant'>
                            <label class="label">Cantidad:</label>
                            <div class="control">
                                <input type="text" id='xcantidad{{i}}' class="input" #size [disabled]='!_producto_seleccionado'>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="field" *ngIf="i == i_montajes_">
                        <label class="label"></label>
                        <div class="control">
                            <button class="button is-success is-outlined" (click)="add_materia3(i, size)">
                                <span class="icon is-small">
                                  <i class="fas fa-check"></i>
                                </span>
                                <span>Agregar</span>
                              </button>
                        </div>
                    </div>
            </div>
            <hr>
            <button class="button is-primary" (click)="editar_producto()">Editar Producto</button>
        </div>
    </div>
</div>